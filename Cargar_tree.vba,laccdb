

Private Sub cargar_tree()
Dim tip As Integer, sq As String, keynodopadre As String, rs As Recordset, nodo As Node
Me.TreeView0.Nodes.Clear
tip = Me.m_tipos
sq = "select * from tipos_Datos where tipo= " & tip & " and idpadre= -1 order by id asc"
Set rs = CurrentDb.OpenRecordset(sq)
While Not rs.EOF
keynodopadre = "a" & rs!id
Set nodo = Me.TreeView0.Nodes.Add(, , keynodopadre, rs!descripcion)
CARGA_HIJO1 (keynodopadre)
rs.MoveNext
Wend
rs.Close
Set rs = Nothing
End Sub
Function CARGA_HIJO1(PA As String)
Dim sq As String, cla As String, rs1 As Recordset, nodo As Node
sq = "select * from tipos_Datos where tipo= " & Me.m_tipos & " and idpadre= " & Mid(PA, 2, Len(PA)) & " order by id asc"
Set rs1 = CurrentDb.OpenRecordset(sq, dbOpenDynaset)
While Not rs1.EOF
cla = "b" & rs1!id
Set nodo = Me.TreeView0.Nodes.Add(PA, 4, cla, rs1!descripcion)
CARGA_HIJO2 (cla)
rs1.MoveNext
Wend
rs1.Close
Set rs1 = Nothing
End Function